MonDemand : a library for logging messages and statistics to the network

Introduction
------------

The MonDemand library is a library for logging messages and statistics to the
network.  By default it uses the Light Weight Event System 
(http://www.lwes.org); however, developers can modify MonDemand to use
the mechanism and protocol of their choice.  This data stream can be
examined by developers and administrators to determine the health and
runtime status of systems using the library.

Initialization
--------------

The first step to using MonDemand is to initialize a client object:

  client = mondemand_client_create (...)

This should be done at program initialization.

Appendix: Event Format
----------------------

If using the Light Weight Event System, here are the ESF entries for the three
types of messages sent by MonDemand.

MonDemand::LogMessage
{
  string prog_id;    # program identifier

  uint16 num;        # number of log messages in this event

  string f0;         # filename or class logging this message
  uint32 l0;         # line number of the calling filename or class
  uint32 p0;         # priority / log level
  string m0;         # the actual message
  uint16 r0;         # repeat count; used if the client detects repeats
  # repeated for num entries

  uint16 ctxt_num;   # number of contextual key/value dimensions

  string ctxt_k0;    # name of contextual metadata
  string ctxt_v0;    # value of contextual metadata
  # repeated for the number of repeated contextual key/value pairs
}

MonDemand::StatsMsg
{
  string prog_id;    # program identifier

  uint16 num;        # number of stats messages in this event
  
  string k0;         # name of the 0th counter
  int64  v0;         # value of the 0th counter
  # repeated for num entries

  uint16 ctxt_num;   # number of contextual key/value dimensions

  string ctxt_k0;    # name of contextual metadata
  string ctxt_v0;    # value of contextual metadata
  # repeated for the number of contextual key/value pairs
}

MonDemand::WorkflowMsg
{
  string prog_id;       # program_identifier

  string resource_id;   # the resource that was affected, e.g. Job ID
  string user_id;       # optional: user that initiated the change
  string system_id;     # the system that triggered the change

  int64 timestamp;      # when this change occurred

  ip_addr client_ip;    # IP address of the client initiating the change
  ip_addr server_ip;    # IP address of the server servicing the request
  string location;      # URL or other locator information about the request

  string action;        # the action that was taken on the resource
  string description;   # a description of the action
  int32 status;         # the result of the action taken

  uint16 attribute_num; # the number of attributes
  string attr_n0;       # the name of the attribute
  string attr_t0;       # the type of the attribute
  string attr_b0;       # the state before the change
  string attr_a0;       # the state after the change
  # repeated for the number of attributes in attribute_num

  uint16 ctxt_num;      # number of contextual key/value dimensions

  string ctxt_k0;       # name of contextual metadata
  string ctxt_v0;       # value of contextual metadata
  # repeated for the number of contextual key/value pairs
}

